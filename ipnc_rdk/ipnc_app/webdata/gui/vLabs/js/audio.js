var origAudioSettings={};var audioSettings={};function saveAudioSettings(a){sendSettings(audioSettings,["audioenable","audioinvolume","audiooutvolume","audiobitrate","audiomode","samplerate","alarmlevel"],function(){checkReload(function(c,b){if(c){$("#updateModal").modal({backdrop:"static",keyboard:false});new modalProgress(b,function(){$("#updateModal").modal("hide");delayedExec(a)})}else{delayedExec(a)}})})}function openAudio(){function b(c){return $.extend({},c,{audioModes:c.audiomodename.split(/;/g),encodings:c.encodingname.split(/;/g),sampleRates:c.sampleratename.split(/;/g),bitRates:c.audiobitratename.split(/;/g)})}function a(c,e,d){return mkCheckButton(c,e,{checked:parseDecimal(origAudioSettings[d])===1,change:function(g){var f=g?1:0;logDebug("changed",d,"to",f,"Originally was",origAudioSettings[d]);audioSettings[d]=f}})}$.ajax({url:IPNC.serverURL+"ini.htm",success:function(g){origAudioSettings=b(parseINI(g));audioSettings=$.extend({},origAudioSettings);function d(){if(audioSettings.audioenable===0){return"disabled"}}var f=mkElem("div",{id:"mainpanel","class":"span8 offset2"},[mkPrependedInput("Camera",{id:"inputCamera",value:audioSettings.title,disabled:"disabled","class":"input-medium"},"icon-camera",""),a("Audio Enable","audioenable","audioenable"),mkSelectionInput("Audio Mode","audioMode",audioSettings.audioModes,{selectedIndex:audioSettings.audiomode,disabled:d(),change:curry(updateFromCombo,audioSettings,"audiomode","audioMode")}),mkElem("legend",{},"Audio Input"),slidingControls("Input Gain","inputgain","val"),mkSelectionInput("Encoding","encoding",audioSettings.encodings,{selectedIndex:audioSettings.encoding,disabled:d(),change:curry(updateFromCombo,audioSettings,"encoding","encoding")}),mkSelectionInput("Sample Rate","sampleRate",audioSettings.sampleRates,{selectedIndex:audioSettings.samplerate,disabled:d(),change:curry(updateFromCombo,audioSettings,"samplerate","sampleRate")}),mkSelectionInput("Bit Rate","audiobitrate",audioSettings.bitRates,{selectedIndex:audioSettings.audiobitrate,disabled:d(),change:curry(updateFromCombo,audioSettings,"audiobitrate","audiobitrate")}),slidingControls("Alarm Level","alarmlevel","alarmval"),mkElem("legend",{},"Audio Output"),slidingControls("Output Volume","outputvolume","outvolumeval")]);var e=mkElemClass("div","form-horizontal row-fluid",f);var c=mkElemClass("div","form-actions",[mkButton("Ok","btn-primary",mkVerboseSaver(saveAudioSettings,"Audio settings saved to "+audioSettings.title,openAudio))," ",mkButton("Cancel",null,openAudio)," "]);$("#mainbar").html(mkElem("div",{},[mkElem("h2",{},"Audio"),mkUpdateModal(),e,mkSaveStatusDiv(),c]));adjustSidebarHeight();connectSliderToInput("inputgain","#val",audioSettings,"audioinvolume",100);connectSlider("alarmlevel","#alarmval",audioSettings,"alarmlevel",100);connectSliderToInput("outputvolume","#outvolumeval",audioSettings,"audiooutvolume",100);$("#audioenable").change(function(){var h=["#audioMode","#encoding","#sampleRate","#audiobitrate"];if(audioSettings.audioenable===0){$.each(h,function(j,k){$(k).removeAttr("disabled")})}else{$.each(h,function(j,k){$(k).attr("disabled","disabled")})}});showPendingStatus()}})}function closeAudio(a){if(isDifferent(origAudioSettings,audioSettings)){showConfirmationModal("Message","Do you want to save the changes?",curry(saveAudioSettings,a),a,true)}else{a()}};