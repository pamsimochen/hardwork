function getStreamSize(a,b){return{width:parseDecimal(a["streamwidth"+b]),height:parseDecimal(a["streamheight"+b])}}function messageWindowTab(c){var a=mkElem("p",{id:c+"Message"},"Hover a control to see detailed Help.");var b=createTab("tabMsgWindow","Message Window","TargetMsgWindow",a);return b}function makeObjectHoverMsg(b,c,a){return capFirstLetter(b)+" "+c+" "+a+": Use mouse to adjust the "+b+" "+a+" of a "+c+" in the scene. The "+a+" of the box will be reflected in this text box as a percentage of the image "+a}function radioCheckButtonSet(a,b,c){return c&&(a&b)}function getStreamResolution(a,b){if(!b){b=1}return[a["streamwidth"+b],a["streamheight"+b]].join(":")}function showHoverMsg(c){var e=["pplMinWdthId","pplMinHghtId","pplMaxWdthId","pplMaxHghtId"];var d=["vhclMinWdthId","vhclMinHghtId","vhclMaxWdthId","vhclMaxHghtId"];function b(g,f){$("#"+c+"Message").text(makeObjectHoverMsg(f<2?"minimum":"maximum",g,(f%2)===0?"width":"height"))}$.each(e,function(f,g){$("#"+g).hover(curry(b,"people",f));validateNumericField("#"+g)});$.each(d,function(f,g){$("#"+g).hover(curry(b,"vehicle",f));validateNumericField("#"+g)});var a=["pplViewChkId","pplModifyChkId","vhclViewChkId","vhclModifyChkId"];$.each(a,function(f,g){$("#"+g).hover(function(){var j=f===0?"People In View":"Modify People Size";var k=f===2?"Vehicle In View":"Modify Vehicle Size";var i=j+" : Select this to indicate that people are present in the field of view of the camera.";var h=k+" : Select this to indicate that vehicles are present in the field of view of the camera.";$("#"+c+"Message").text(f<=1?i:h)})});$("#selectSensitivityId ").hover(function(){var f="Sensitivity: Choose sensitivity setting. Note that higher sensitivity might result in more false alarms.";$("#"+c+"Message").text(f)})}function showDirHoverMessages(c,a){var b=["Bi-directional: Select this option to detect object crossing in either direction between Zones 1 and 2.","Zone 1 to 2: Select this option to only detect objects crossing from Zone 1 to Zone 2.","Zone 2 to 1: Select this option to only detect objects crossing from Zone 2 to Zone 1."];$.each(a,function(d,e){$(e).hover(function(){$("#"+c+"Message").text(b[d])})})}function uncheckModifyBox(a){videoManager.setProperty("enableObjt",0,a);$.each(["#pplModifyChkId","#vhclModifyChkId"],function(b,c){$(c).attr("checked",false)})}function getObjectMinSize(b,d,c,a){if(a){return[b["dmva"+d+c+"minwidthlimit"],b["dmva"+d+c+"minheightlimit"]].join(":")}return[b["dmva"+d+c+"minwidth"],b["dmva"+d+c+"minheight"]].join(":")}function getObjectMaxSize(b,d,c,a){if(a){return[b["dmva"+d+c+"maxwidthlimit"],b["dmva"+d+c+"maxheightlimit"]].join(":")}return[b["dmva"+d+c+"maxwidth"],b["dmva"+d+c+"maxheight"]].join(":")}function getObjectLimits(b,d,c,a){return[getObjectMinSize(b,d,c,a),getObjectMaxSize(b,d,c,a)].join(",")}function minMaxBoxclicked(j,e,d,i){var a=e[d+"DefaultLimits"].split(/,/g);var f=a[0].split(/:/g);var b=a[1].split(/:/g);var h=i[0].split(/:/g);var k=i[1].split(/:/g);var g=parseDecimal(h[2]);var m=parseDecimal(h[3]);var c=parseDecimal(k[2]);var l=parseDecimal(k[3]);if(j===1){if(g>c){g=Math.max(parseDecimal(f[0]),c-1)}else{g=Math.max(parseDecimal(f[0])+1,g)}if(m>l){m=Math.max(parseDecimal(f[1]),l-2)}else{m=Math.max(parseDecimal(f[1])+1,m)}}else{if(j===2){if(g>c){c=Math.min(parseDecimal(b[0]),g+1)}else{c=Math.min(parseDecimal(b[0]),c)}if(m>l){l=Math.min(parseDecimal(b[1]),m+2)}else{l=Math.min(parseDecimal(b[1]),l)}}}return[h[0],h[1],g,m,k[0],k[1],c,l]}function handleObjResize(h,f,e,l,d,n,k){logDebug("index is ........in handle",k);var c=f.objModifyingPrefix;var b=videoManager.getProperty("objSize");var j=b.split(/,/g);var m=(c==="ppl")?"person":"vehicle";var g=minMaxBoxclicked(k,f,c,j);f["dmva"+e+m+"minwidth"]=g[2];f["dmva"+e+m+"minheight"]=g[3];f["dmva"+e+m+"maxwidth"]=g[6];f["dmva"+e+m+"maxheight"]=g[7];$("#"+c+"MinWdthId").val(g[2]);$("#"+c+"MinHghtId").val(g[3]);$("#"+c+"MaxWdthId").val(g[6]);$("#"+c+"MaxHghtId").val(g[7]);$("#objTable").html(mkElemClass("div","",createTab("tabObj",h,"tabObjTarget",mkObjectTable(f,l,d))));var a=g[2]+":"+g[3]+","+g[6]+":"+g[7];$("#"+c+"ModifyChkId").attr("checked",true);$("#mainbar .nav-tabs a").tab("show");var i=[[g[0],g[1],g[2],g[3]].join(":"),[g[4],g[5],g[6],g[7]].join(":")].join(",");videoManager.setProperty("objSize",i,n);videoManager.setProperty("objLimits",f[c+"DefaultLimits"],n);videoManager.setProperty("objLimits",a,n);videoManager.setProperty("enableObjt",1,n)}function mkObjectTable(c,b,e,f){function d(h,i,g,j){return[mkElem("label",{},h),mkInlineCheckButtonElem(" ",i+"ViewChkId",{checked:isBitSet(c[b[6]],j),change:function(k){c[b[6]]=changeBitOf(c[b[6]],j,k)}}),mkInlineCheckButtonElem(" ",i+"ModifyChkId",{checked:c.objModifyingPrefix===i,change:function(n){if(n){$("#"+(i==="ppl"?"vhcl":"ppl")+"ModifyChkId").attr("checked",false);c.objModifyingPrefix=i;var l=i==="ppl"?"person":"vehicle";var m=[[10,30,getObjectMinSize(c,c.currScreen,l)].join(":"),[40,40,getObjectMaxSize(c,c.currScreen,l)].join(":")].join(",");var k=getObjectLimits(c,c.currScreen,l);videoManager.setProperty("enableObjt",0,f);videoManager.setProperty("objSize",m,f);videoManager.setProperty("objLimits",c[i+"DefaultLimits"],f);videoManager.setProperty("objLimits",k,f);videoManager.setProperty("enableObjt",1,f)}else{videoManager.setProperty("enableObjt",0,f);c.objModifyingPrefix=null}}}),[mkInputElem({id:i+"MinWdthId",maxlength:2,"class":"input-micro",value:c[g[0]],change:curry(updateFromInput,c,g[0],i+"MinWdthId")}),"&nbsp;%"],[mkInputElem({id:i+"MinHghtId",maxlength:2,"class":"input-micro",value:c[g[1]],change:curry(updateFromInput,c,g[1],i+"MinHghtId")}),"&nbsp;%"],[mkInputElem({id:i+"MaxWdthId",maxlength:2,"class":"input-micro",value:c[g[2]],change:curry(updateFromInput,c,g[2],i+"MaxWdthId")}),"&nbsp;%"],[mkInputElem({id:i+"MaxHghtId",maxlength:2,"class":"input-micro",value:c[g[3]],change:curry(updateFromInput,c,g[3],i+"MaxHghtId")}),"&nbsp;%"]]}var a=curry(updateFromCombo,c,b[5],"selectSensitivityId");return mkElemClass("div","",[mkControlGroup("Sensitivity",mkInlineSelectionInput("","selectSensitivityId",c[b[4]],{selectClass:"input-large",selectedIndex:c[b[5]]-1,change:function(){a();c[b[5]]=c[b[5]]+1}})),mkTable([],[["Object Size","In View","Modify",{label:"Minimum",options:{colspan:2}},{label:"Maximum",options:{colspan:2}}],[null,null,null,"Width","Height","Width","Height"],d("People","ppl",b,3),d("Vehicles","vhcl",e,2)],{tableClass:"actionControlTable"})])}var dmvaRGBList=[[255,0,0],[255,255,0],[0,255,0],[0,0,255],[254,1,215],[3,255,237],[0,0,0],[255,255,255],[255,114,0],[107,206,214],[0,130,132],[201,0,5],[207,85,0],[255,191,43],[34,139,34],[0,193,13],[153,0,93],[135,0,44],[0,52,107],[0,52,57],[76,76,76],[161,161,161]];function getRGB(a){return dmvaRGBList[a-1].join(",")}function setOverlayProperties(a,b){var c=a.dmvaoverlaypropertiesfontsizelist.split(/;/g);videoManager.setProperty("setFontType",a.dmvaoverlaypropertiesfonttype,b);videoManager.setProperty("setFontSize",parseDecimal(c[a.dmvaoverlaypropertiesfontsize]),b);videoManager.setProperty("rectColor",getRGB(a.dmvaoverlaypropertiesboxcolor),b);videoManager.setProperty("zoneColor",getRGB(a.dmvaoverlaypropertiesactivezonecolor)+","+getRGB(a.dmvaoverlaypropertiesinactivezonecolor),b);videoManager.setProperty("fontColor",getRGB(a.dmvaoverlaypropertiesfontcolor),b);videoManager.setProperty("centroidColor",getRGB(a.dmvaoverlaypropertiescentriodcolor),b);videoManager.setProperty("velocityColor",getRGB(a.dmvaoverlaypropertiesvelocitycolor),b);videoManager.setProperty("streamResolution",getStreamResolution(a),b)}function createVertices(b,a){var c=b.slice(0);var d=a-b.length;$.each(range(d),function(e,f){c.push([0,0])});return map(c,function(f,e){return e.join(":")}).join(";")}function createZone(a,b){return[a.length,b,createVertices(a,16)].join(";")}function validateSettingsFileName(a,e){var d=/[^a-zA-Z0-9\.]/g;function c(){var g=$(a).val();var f=g.replace(d,"");if(g!==f){$(a).val(f)}if(e){e(f)}}function b(f){return keyEventCheck(f,[isASCIIControlKey,isASCIINumKey,isASCIIAlphabetKey,curry(isASCIISpecialKey,[ASCII.PERIOD])])}registerChangeHandlers($(a),c).keypress(b)}function mkFileNameModal(a,e,d,c,b,i){var g="";if(e[d]&&e[d].length>0){g=e[d].split(/;/g)}var f=mkInlineInput({id:"inputFileName"+a,"class":"input-large",maxlength:32,label:" ",value:i+"Current.prm"});function k(){$("#inputFileName"+a).val(i+"Current.prm");$("#"+a+"fnModal").modal("hide");videoManager.showAll()}var j=mkElem("div",{id:"fNFooter"+a},[mkButton("OK"," ").click(function(){e["dmva"+a+"save"]=$("#inputFileName"+a).val();$("#"+a+"fnModal").modal("hide");c(a,g,b)}),mkButton("Cancel"," ",k)]);var h=$.extend({},standardModalOptions,{show:false});return mkModalElem(a+"fnModal"," ","Enter File Name ",f,j,h,true,k)}function checkFileNameExistAndExtension(e,a){var d=false;var c="";if(e.length===0){d=true;c="Please enter file name to save settings."}else{d=exists(a,function(g,f){return e==f});if(d){c="A file with that name alread exists: "+e+"."}else{d=e.slice(-4)!==".prm";if(d){c="The file name should end with .prm extension."}else{var b=e.charAt(0);d=b.search(/[0-9\.]/)!==-1;if(d){c="The file name should start with an alphabet."}}}}return{err:d,errMsg:c}}function saveSettings(d,a,c){var b=checkFileNameExistAndExtension($("#inputFileName"+d).val(),a);if(b.err){$("#"+d+"fnModal").modal("hide");showOverlaidMessageModal("Message",b.errMsg,function(){videoManager.hideAll();$("#"+d+"fnModal").modal("show")})}else{$("#"+d+"fnModal").modal("hide");c();videoManager.showAll()}}function saveSettingsModal(d,c){logDebug("\n\nSaving settings modal: ",d);function b(){videoManager.hideAll();$("#"+d+"fnModal").modal("show")}if($.isFunction(c)){var a=c();if(a.valid){b()}else{$("#"+d+"fnModal").modal("hide");showOverlaidMessageModal("Message",a.msg)}}else{b()}}function parseLoadNames(a){if(a&&a.length>0){return a.split(/;/)}else{return[]}}function loadSelectedSetting(b,e,d){if(b.loadNames.length>0){var a=getIndexFromCombo("selectLoadSettings");var c={};c[e]=a;$.ajax({url:IPNC.serverURL+"vb.htm",data:c,success:curry(delayedExec,d)})}}function connectSlider(a,b,c,i,g){var d=1/g;var e={editing:false};var f=new Dragdealer(a,{x:(c[i]===1?0:c[i])*d,animationCallback:function(j,l){var k=Math.round(j*g);if(k===0){k=1}if(!e.editing){$(b).val(k)}},callback:function(j){var k=Math.round(j*g);e.editing=false;if(k===0){k=1}c[i]=k}});function h(){var k=$(b).val();var j=k.length===0?0:parseDecimal(k);j=Math.min(g,Math.max(j,0));e.editing=true;if(k!==(""+j)){$(b).val(j)}var l=j;if(j===1){l=j-1}f.setValue(l*d);c[i]=j}registerChangeHandlers($(b),h).keypress(filterNumKey)};