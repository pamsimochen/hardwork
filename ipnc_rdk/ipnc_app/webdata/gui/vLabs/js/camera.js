var origCameraSettings={},cameraSettings={};function saveCameraSettings(a){sendSettings(cameraSettings,["brightness","contrast","sharpness","saturation","backlight","awb","dynrange","exposurectrl","lensdistortcorrection","histogram","priority","maxexposuretime","colorkiller","maxgain","img2a","img2atype","nfltctrl","blc","vidstb1","lensdistortcorrection","tnfltctrl","binning"],function(){checkReload(function(b){if(b){videoManager.stopAndHide();$("#updateModal").modal({backdrop:"static",keyboard:false});new modalProgress(parseDecimal(cameraSettings.reloadtime),function(){$("#updateModal").modal("hide");delayedExec(a)})}else{delayedExec(a)}})})}function openCamera(){var a={};var c={};function b(d){return $.extend({},d,{backlights:d.backlightname.split(/;/g),dynamicranges:d.dynrangename.split(/;/g),fickercontrols:d.exposurename.split(/;/g),whiteBalances:d.awbname.split(/;/g),proirities:d.priorityname.split(/;/g),imag2aTypes:d.img2atypename.split(/;/g),maxexposuretimes:d.maxexposuretimename.split(/;/g),maxgains:d.maxgainname.split(/;/g),noisefilters:d.nfltctrlname.split(/;/g),imageSensors:d.binningname.split(/;/g),img2as:d.img2aname.split(/;/g)})}$.ajax({url:IPNC.serverURL+"ini.htm",success:function(k){var p=parseINI(k);origCameraSettings=b(p);cameraSettings=$.extend({},origCameraSettings);c=initVideoSettings(p);a=getPluginWidthAndHeight(cameraSettings,getMainBarHalfAvailableSpace(),1);var l=mkRadioButtons("Back Light Compensation","light",["Off","On"],{callback:function(q){cameraSettings.blc=q},selectedIndex:cameraSettings.blc});var o=mkRadioButtons("Lighting Condition","mode",["Day","Night"],{callback:function(q){cameraSettings.colorkiller=1-q},selectedIndex:1-cameraSettings.colorkiller});var i=mkRadioButtons("Histogram","histogram",["Off","On"],{callback:function(q){cameraSettings.histogram=q},selectedIndex:cameraSettings.histogram});var j=mkRadioButtons("Video Stabilisation","vidstl",["Off","On"],{callback:function(q){cameraSettings.vidstb1=q},selectedIndex:cameraSettings.vidstb1});var n=mkRadioButtons("Lens Distortion Correction","lensdistortcorrection",["Off","On"],{callback:function(q){cameraSettings.lensdistortcorrection=q},selectedIndex:cameraSettings.lensdistortcorrection});var g=mkRadioButtons("Noise Filter","noisefilter",["Off","On"],{callback:function(q){cameraSettings.tnfltctrl=q},selectedIndex:cameraSettings.tnfltctrl});function e(){console.log("disabled"+cameraSettings.blc);if(cameraSettings.blc===1){return false}else{return true}}var h=mkElem("div",{id:"leftPanel","class":"span6"},[mkPrependedInput("Camera",{id:"inputCamera",value:cameraSettings.title,disabled:"disabled","class":"input-medium"},"icon-camera",""),mkElem("h4",{},"Lighting Condition"),slidingControls("Brightness ","brightnessId","brightId"),slidingControls("Contrast ","contrastId","inputcontastId"),slidingControls("Saturation ","saturationId","saturateId"),slidingControls("Sharpness ","sharpnessId","sharpId"),l,mkSelectionInput("Backlight Level","selectBackLightId",cameraSettings.backlights,{selectedIndex:cameraSettings.backlight,disabled:e(),change:curry(updateFromCombo,cameraSettings,"backlight","selectBackLightId")}),mkSelectionInput("Image Sensor Mode","selectImageSensorId",cameraSettings.imageSensors,{selectedIndex:cameraSettings.binning}),o,i,j,n,mkElem("h4",{},"Dynamic Range Enhancement[DRE]"),mkSelectionInput("DRE Mode","selectDreMode",cameraSettings.dynamicranges,{selectedIndex:cameraSettings.dynrange,change:curry(updateFromCombo,cameraSettings,"dynrange","selectDreMode")}),mkSelectionInput("DRE Strength ","selectDreStrength",cameraSettings.maxgains,{selectedIndex:cameraSettings.maxgain,change:curry(updateFromCombo,cameraSettings,"maxgain","selectDreStrength")}),]);var m=mkElem("div",{id:"rightPanel","class":"span6"},[centerWrap(mkElemId("div","videoAnchorCamera")),mkSelectionInput("2A Engine","selectEngineId",cameraSettings.img2as,{selectedIndex:cameraSettings.img2a,change:curry(updateFromCombo,cameraSettings,"img2a","selectEngineId")}),mkSelectionInput("2A Mode","selectModeId",cameraSettings.imag2aTypes,{selectedIndex:cameraSettings.img2atype,change:curry(updateFromCombo,cameraSettings,"img2atype","selectModeId")}),mkSelectionInput("Priority","selectPriorityId",cameraSettings.proirities,{selectedIndex:cameraSettings.priority,change:curry(updateFromCombo,cameraSettings,"priority","selectPriorityId")}),mkSelectionInput("Flicker Control","selectFlickerId",cameraSettings.fickercontrols,{selectedIndex:cameraSettings.exposurectrl,change:curry(updateFromCombo,cameraSettings,"exposurectrl","selectFlickerId")}),mkSelectionInput("Whitebalance Mode","selectbalanceId",cameraSettings.whiteBalances,{selectedIndex:cameraSettings.awb,change:curry(updateFromCombo,cameraSettings,"awb","selectbalanceId")}),mkElem("h4",{},"Video Noise Filter[VNF]"),g,mkSelectionInput("VNF Mode","selectVnfMode",cameraSettings.noisefilters,{selectedIndex:cameraSettings.nfltctrl,change:curry(updateFromCombo,cameraSettings,"nfltctrl","selectVnfMode")}),mkSelectionInput("VNF Strength","selectVnfStrength",cameraSettings.maxexposuretimes,{selectedIndex:cameraSettings.maxexposuretime,change:curry(updateFromCombo,cameraSettings,"maxexposuretime","selectVnfStrength")})]);var f=mkElemClass("div","form-horizontal form-inline row-fluid",[h,m]);var d=mkElemClass("div","form-actions",[mkButton("Ok","btn-primary",mkVerboseSaver(saveCameraSettings,"Camera settings saved to "+cameraSettings.title,openCamera))," ",mkButton("Cancel",null,openCamera)," "]);$("#mainbar").html(mkElem("div",{},[mkElem("h2",{},"Camera"),mkUpdateModal(),f,mkSaveStatusDiv(),d]));adjustSidebarHeight();connectSliderToInput("brightnessId","#brightId",cameraSettings,"brightness",255);connectSliderToInput("contrastId","#inputcontastId",cameraSettings,"contrast",255);connectSliderToInput("saturationId","#saturateId",cameraSettings,"saturation",255);connectSliderToInput("sharpnessId","#sharpId",cameraSettings,"sharpness",255);$("#light1").change(function(){$("#selectBackLightId").removeAttr("disabled")});$("#light0").change(function(){$("#selectBackLightId").attr("disabled","disabled")});addVideoDiv(c,"#videoAnchorCamera",a.width,a.height,"videoCamera");videoManager.play(c.getStreamUrl(0));showPendingStatus()}})}function closeCamera(a){if(isDifferent(origCameraSettings,cameraSettings)){$(".videoContainer").hide();showConfirmationModal("Message","Do you want to save the changes?",curry(saveCameraSettings,a),a,true)}else{a()}};